@page "/Sanpham/Edit/{id}"
@inject IJSRuntime JS
@using Model
@using Model.DataDB
@using Model.Dto
@using Web_Admin_Client.Service
@using Web_Admin_Client.Services
@inject NavigationManager NavigationManager;





  <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title"> Form elements </h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Forms</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Form elements</li>
                </ol>
              </nav>
            </div>
            <div class="row">
              <div class="col-md-6 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Default form</h4>
                    <p class="card-description"> Basic form layout </p>
                        <EditForm Model="sanphamdto">
                            <form class="forms-sample">
                                <div class="form-group">
                                    <label for="exampleInputUsername1">Mã sản phẩm</label>
                                    <InputText class="form-control" placeholder="" @bind-Value="sanphamdto.MaSp"></InputText>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Tên sản phẩm</label>
                                    <InputText class="form-control" placeholder="" @bind-Value="sanphamdto.TenSp"></InputText>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputPassword1">Giá sản phẩm</label>
                                    <InputNumber class="form-control" placeholder="" @bind-Value="sanphamdto.GiaSp"></InputNumber>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputConfirmPassword1">Bảo hàng</label>
                                    <InputNumber class="form-control" placeholder="" @bind-Value="sanphamdto.Baohanh"></InputNumber>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputConfirmPassword1">Loại sản phẩm</label>
                                    <InputSelect class="form-select" placeholder="" @bind-Value="sanphamdto.MaLoai">
                                        @foreach (var item in loaisp)
                                        {
                                            <option value="@item.MaLoai">@item.Tenloai</option>
                                        }
                                    </InputSelect>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputConfirmPassword1">Hãng sản xuất</label>
                                    <InputSelect class="form-select" placeholder="" @bind-Value="sanphamdto.MaHsx">
                                        @foreach (var item in hsx)
                                        {
                                            <option value="@item.MaHsx">@item.TenHsx</option>
                                        }
                                    </InputSelect>
                                </div>


                                <button class="btn btn-light">Cancel</button>
                            </form>
                            <button type="button" class="btn btn-gradient-primary me-2" @onclick="Submit">Lưu</button>
                        </EditForm>
                  </div>
                </div>
              </div>
             
            </div>
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:../../partials/_footer.html -->
          
          <!-- partial -->
        </div>




@code {
    [Parameter] 
    public string id{ get; set; }
    private SanphamEdit sanphamdto = new SanphamEdit();
    SanphamService sanphamService = new SanphamService();
    List<LoaiSp> loaisp = new List<LoaiSp>();
    LoaiSpService loaiSpService = new LoaiSpService();
    List<Hx> hsx = new List<Hx>();
    HsxService hsxService = new HsxService();
    IFormFile myfile ;
    List<IFormFile> myfiles = new List<IFormFile>();

    protected async override Task OnInitializedAsync()
    {
        var result = await sanphamService.GetProduct(id);
        loaisp = await loaiSpService.GetListLoaiSp();
        hsx = await hsxService.GetListHsx();

        sanphamdto.MaSp = result.MaSp;
        sanphamdto.TenSp = result.TenSp;
        sanphamdto.Mota = result.Mota;
        sanphamdto.GiaSp = result.GiaSp;
        sanphamdto.MaHsx = result.MaHsx;
        sanphamdto.MaLoai = result.MaLoai;
        sanphamdto.Baohanh = result.Baohanh;
    }
    private async void Submit()
    {
        await sanphamService.EditSanpham(id, sanphamdto);
        NavigationManager.NavigateTo("/Sanpham/Index");
        
    }
}
