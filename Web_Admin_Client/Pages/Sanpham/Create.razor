@page "/Sanpham/Create"
@inject IJSRuntime JS
@using Model
@using Model.DataDB
@using Model.Dto
@using Web_Admin_Client.Service
@using Web_Admin_Client.Services
@inject NavigationManager NavigationManager;



<div class="modal @modalClass" tabindex="-1" role="dialog" style="display:@modalDisplay; overflow-y: auto;">
    <div class="modal-dialog modal-lg" role="document" style="max-width:40%">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Thêm mới sản phẩm</h5>
            </div>
            <div class="modal-body">
                <EditForm Model="sanphamdto">
                    <form class="forms-sample">
                        <div class="form-group">
                            <label for="exampleInputUsername1">Mã sản phẩm</label>
                            <InputText class="form-control" placeholder="" @bind-Value="sanphamdto.MaSp" @ref=masanpham></InputText>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Tên sản phẩm</label>
                            <InputText class="form-control" placeholder="" @bind-Value="sanphamdto.TenSp" @ref=tensanpham></InputText>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputPassword1">Giá sản phẩm</label>
                            <InputNumber class="form-control" placeholder="" @bind-Value="sanphamdto.GiaSp" @ref=giasanpham></InputNumber>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputConfirmPassword1">Bảo hàng</label>
                            <InputNumber class="form-control" placeholder="" @bind-Value="sanphamdto.Baohanh" @ref=baohanh></InputNumber>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputConfirmPassword1">Loại sản phẩm</label>
                            <InputSelect class="form-select" placeholder="" @bind-Value="sanphamdto.MaLoai" @ref=loaisanpham>
                                @foreach (var item in loaisp)
                                {
                                    <option value="@item.MaLoai">@item.Tenloai</option>
                                }
                            </InputSelect>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputConfirmPassword1">Hãng sản xuất</label>
                            <InputSelect class="form-select" placeholder="" @bind-Value="sanphamdto.MaHsx" @ref=hangsx>
                                @foreach (var item in hsx)
                                {
                                    <option value="@item.MaHsx">@item.TenHsx</option>
                                }
                            </InputSelect>
                        </div>
                    </form>
                    <button type="button" class="btn btn-gradient-primary" @onclick="Create_Sanpham" style="margin-left:19%">Lưu</button>
                    <button type="button" class="btn btn-gradient-primary" data-dismiss="modal" @onclick="Close" style="margin-left:19%">Hủy</button>
                </EditForm>
            </div>
        </div>
    </div>
</div>

@if (showBackdrop)
{
        <div class="modal-backdrop fade show"></div>
}
   





  
@code {


    private string modalDisplay = "none;";
    private string modalClass = "";
    private bool showBackdrop = false;

    public void Open()
    {
        modalDisplay = "block;";
        modalClass = "show";
        showBackdrop = true;
        StateHasChanged();
    }

    public void Close()
    {
        modalDisplay = "none";
        modalClass = "";
        showBackdrop = false;
    }

    private SanphamEdit sanphamdto = new SanphamEdit();
    SanphamService sanphamService = new SanphamService();
    List<LoaiSp> loaisp = new List<LoaiSp>();
    LoaiSpService loaiSpService = new LoaiSpService();
    List<Hx> hsx = new List<Hx>();
    HsxService hsxService = new HsxService();
    private InputText masanpham;
    private InputText tensanpham;
    private InputNumber<int> giasanpham;
    private InputNumber<int> baohanh;
    private InputSelect<string> loaisanpham;
    private InputSelect<string> hangsx;


    protected override async Task OnInitializedAsync()
    {
        loaisp = await loaiSpService.GetListLoaiSp();
        hsx = await hsxService.GetListHsx();
    }

    private async void Create_Sanpham()
    {
        
            sanphamdto.MaSp = masanpham.Value;
            sanphamdto.TenSp = tensanpham.Value;
            sanphamdto.GiaSp = giasanpham.Value;
            sanphamdto.Baohanh = baohanh.Value;
            sanphamdto.MaLoai = loaisanpham.Value;
            sanphamdto.MaHsx = hangsx.Value;
            await sanphamService.CreateSanpham(sanphamdto);
            NavigationManager.NavigateTo("/Sanpham/Index");
  
    }
}
